<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<meta name="keywords" content="definition" />
	<meta name="description" content="definition" />
	<!-- 网页标签标题 -->
	<title>definition</title>
	<link rel="shortcut icon" href="/thain/img/docsite.ico"/>
	<link rel="stylesheet" href="/thain/build/documentation.css" />
</head>
<body>
	<div id="root"><div class="documentation-page" data-reactroot=""><header class="header-container header-container-normal"><div class="header-body"><a href="/thain/zh-cn/index.html"><img class="logo" src="/thain/img/thain-logo.png"/></a><div class="search search-normal"><span class="icon-search"></span></div><span class="language-switch language-switch-normal">En</span><div class="header-menu"><img class="header-menu-toggle" src="/thain/img/system/menu_gray.png"/><ul><li class="menu-item menu-item-normal"><a href="/thain/zh-cn/index.html" target="_self">首页</a></li><li class="menu-item menu-item-normal menu-item-normal-active"><a href="/thain/zh-cn/docs/quick_start.html" target="_self">文档</a></li></ul></div></div></header><div class="bar"><div class="bar-body"><img src="/thain/img/system/docs.png" class="front-img"/><span>文档</span><img src="/thain/img/system/docs.png" class="back-img"/></div></div><section class="content-section"><div class="sidemenu"><div class="sidemenu-toggle"><img src="https://img.alicdn.com/tfs/TB1E6apXHGYBuNjy0FoXXciBFXa-200-200.png"/></div><ul><li class="menu-item menu-item-level-1"><span>基本操作</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/thain/zh-cn/docs/quick_start.html" target="_self">快速启动</a></li><li style="height:72px;overflow:hidden" class="menu-item menu-item-level-2"><span>页面使用<img style="transform:rotate(0deg)" class="menu-toggle" src="/thain/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/page-usage/create-flow.html" target="_self">创建Flow</a></li></ul></li><li style="height:108px;overflow:hidden" class="menu-item menu-item-level-2"><span>定制部署<img style="transform:rotate(0deg)" class="menu-toggle" src="/thain/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/custom-deployment/database.html" target="_self">数据库</a></li><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/custom-deployment/user.html" target="_self">用户管理</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/thain/zh-cn/docs/http-callback.html" target="_self">HTTP回调</a></li></ul></li><li class="menu-item menu-item-level-1"><span>组件使用</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/thain/zh-cn/docs/component/introduction.html" target="_self">组件说明</a></li><li style="height:144px;overflow:hidden" class="menu-item menu-item-level-2"><span>std组件<img style="transform:rotate(0deg)" class="menu-toggle" src="/thain/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/component/std/shell.html" target="_self">Shell</a></li><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/component/std/http.html" target="_self">HTTP</a></li><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/component/std/mail.html" target="_self">邮件</a></li></ul></li><li style="height:108px;overflow:hidden" class="menu-item menu-item-level-2"><span>自定义组件<img style="transform:rotate(0deg)" class="menu-toggle" src="/thain/img/system/arrow_down.png"/></span><ul><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/component/customize/definition.html" target="_self">组件定义</a></li><li class="menu-item menu-item-level-3"><a href="/thain/zh-cn/docs/component/customize/implementation.html" target="_self">组件实现</a></li></ul></li><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/thain/zh-cn/docs/component/example.html" target="_self">组件组合使用示例</a></li></ul></li><li class="menu-item menu-item-level-1"><span>FAQ</span><ul><li style="height:36px;overflow:hidden" class="menu-item menu-item-level-2"><a href="/thain/zh-cn/docs/faq/faq.html" target="_self">FAQ</a></li></ul></li></ul></div><div class="doc-content markdown-body"><!--
 Copyright (c) 2019, Xiaomi, Inc.  All rights reserved.
 This source code is licensed under the Apache License Version 2.0, which
 can be found in the LICENSE file in the root directory of this source tree.
-->
<h1>组件定义</h1>
<p>组件通过 json 进行的定义。</p>
<h2>目的</h2>
<ol>
<li>前端可拖动组件的生成</li>
<li>后端创建 flow 的时候，对 job 输入的内容进行校验</li>
</ol>
<h2>组件定义 json 的格式</h2>
<p>一个满足标准的 json，需要满足如下 typescript 定义。</p>
<p>可以用<a href="https://app.quicktype.io/">这个网站</a>生成 json 定义</p>
<pre><code class="language-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> ComponentDefine {
  group: <span class="hljs-built_in">string</span>;
  name: <span class="hljs-built_in">string</span>;
  hidden: <span class="hljs-built_in">boolean</span>;
  items: ComponentDefineItem[];
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">interface</span> ComponentDefineItem {
  <span class="hljs-comment">/**
   * 传到后端的key
   */</span>
  property: <span class="hljs-built_in">string</span>;
  <span class="hljs-comment">/**
   * 是否必填，false 或不写 则为不是必填
   */</span>
  required?: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">/**
   * 输入框前面的标识，不写默认用property
   */</span>
  label?: <span class="hljs-built_in">string</span>;
  input:
    | {
        id: <span class="hljs-string">"line"</span> | <span class="hljs-string">"textarea"</span> | <span class="hljs-string">"sql"</span> | <span class="hljs-string">"shell"</span> | <span class="hljs-string">"richText"</span> | <span class="hljs-string">"uploadBase64"</span>;
      }
    | {
        id: <span class="hljs-string">"select"</span>;
        options: <span class="hljs-built_in">Array</span>&lt;{
          <span class="hljs-comment">/**
           * 属性的值
           */</span>
          id: <span class="hljs-built_in">string</span>;
          <span class="hljs-comment">/**
           * 下拉框中的候选项，不写用id代替
           */</span>
          name?: <span class="hljs-built_in">string</span>;
        }&gt;;
      };
}
</code></pre>
<h2>举个例子</h2>
<p>参考 std::mail 组件的 json 定义。</p>
<pre><code class="language-json">{
  <span class="hljs-attr">"group"</span>: <span class="hljs-string">"std"</span>,
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"mail"</span>,
  <span class="hljs-attr">"hidden"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">"items"</span>: [
    {
      <span class="hljs-attr">"property"</span>: <span class="hljs-string">"title"</span>,
      <span class="hljs-attr">"label"</span>: <span class="hljs-string">"邮件标题"</span>,
      <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">"input"</span>: {
        <span class="hljs-attr">"id"</span>: <span class="hljs-string">"textarea"</span>
      }
    },
    {
      <span class="hljs-attr">"property"</span>: <span class="hljs-string">"contentHtml"</span>,
      <span class="hljs-attr">"label"</span>: <span class="hljs-string">"邮件内容"</span>,
      <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">"input"</span>: {
        <span class="hljs-attr">"id"</span>: <span class="hljs-string">"richText"</span>
      }
    },
    {
      <span class="hljs-attr">"property"</span>: <span class="hljs-string">"recipient"</span>,
      <span class="hljs-attr">"label"</span>: <span class="hljs-string">"收件人（多个用逗号隔开）"</span>,
      <span class="hljs-attr">"required"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-attr">"input"</span>: {
        <span class="hljs-attr">"id"</span>: <span class="hljs-string">"textarea"</span>
      }
    }
  ]
}
</code></pre>
<p>group: 组件分类</p>
<p>name: 组件名称</p>
<p>hidden: 组件在前端是否影藏</p>
<p>item: 每一个 property 都是用户可以在页面输入的项</p>
<h2>页面支持的 input 类型</h2>
<ol>
<li>line
<ul>
<li>单行文本框</li>
</ul>
</li>
<li>textarea
<ul>
<li>多行文本框</li>
</ul>
</li>
<li>sql
<ul>
<li>sql 输入框</li>
</ul>
</li>
<li>shell
<ul>
<li>shell 输入框</li>
</ul>
</li>
<li>richText
<ul>
<li>富文本编辑器</li>
</ul>
</li>
<li>uploadBase64
<ul>
<li>文件上传</li>
</ul>
</li>
<li>select
<ul>
<li>下拉单选框</li>
</ul>
</li>
</ol>
<p>如果还有你需要的，可以提 issus。</p>
</div></section><footer class="footer-container"><div class="footer-body"><div class="copyright"><span>Copyright © 2020 XIAOMI </span></div></div></footer></div></div>
	<script src="https://f.alicdn.com/react/15.4.1/react-with-addons.min.js"></script>
	<script src="https://f.alicdn.com/react/15.4.1/react-dom.min.js"></script>
	<script>
		window.rootPath = '/thain';
  </script>
	<script src="/thain/build/documentation.js"></script>
</body>
</html>